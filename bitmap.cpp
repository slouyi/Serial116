void CHTLineSysDlg::OnPrint(CString stroperation,CString strRemark,CString strnumber)

{	

	HANDLE hComm;
	COleDateTime oletime;
	char chineseforml[50];
	char chineseforml1[50];
	char chineseformS[50];
	char chineseformS1[50];
	char characterformL[50];
	char characterformL1[50];
	char characterformS[50];
	char chineseformS2[50];
	char bitmapform[1024];
	char bitmapform1[1024];
	char bitmapform2[1024];
	char bitmapform3[1024];
	char bitmapform4[1024];


	///////////////////////////////////////工商银行/////////////////////////////////////
	char bitmapcode[1024]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x03,0x03,0x07,0x0F,0x0F,0x0E,0x0E,0x0E,
		0x0E,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0E,0x0E,0x0E,0x0E,0x0F,0x07,0x07,
		0x03,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x01,0x01,0x01,0x01,0x01,0x01,0x1F,0x1F,
		0x11,0x01,0x01,0x01,0x01,0x01,0x03,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x1F,0x0F,
		0x08,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x0B,0x0B,0x09,0x08,0x1F,
		0x1F,0x08,0x00,0x00,0x00,0x00,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x03,0x03,
		0x02,0x02,0x02,0x02,0x02,0x06,0x06,0x06,0x02,0x00,0x00,0x00,0x00,0x00,0x04,0x04,
		0x04,0x04,0x04,0x06,0x07,0x05,0x04,0x14,0x1C,0x1C,0x04,0x07,0x07,0x06,0x04,0x04,
		0x0C,0x0C,0x0C,0x04,0x00,0x00,0x00,0x01,0x0F,0x1E,0x1A,0x12,0x02,0x07,0x02,0x1F,
		0x0F,0x09,0x09,0x09,0x09,0x09,0x09,0x0F,0x0F,0x08,0x00,0x00,0x00,0x00,0x01,0x02,
		0x06,0x1D,0x1B,0x11,0x00,0x00,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x0C,0x0C,
		0x05,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};

	char bitmapcode1[1024]={0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x3F,0x7F,0xFF,0xF0,0xE0,0xC0,0x80,0xFE,0xFE,0xFE,0xEE,0xEE,0xEF,0xEF,
		0xEF,0xEF,0x00,0xEF,0xEF,0xEF,0xEF,0xEE,0xEE,0xFE,0xFE,0xFE,0xFE,0x80,0xE0,0xE0,
		0xF8,0xFF,0x7F,0x1F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0xF8,0x10,0x10,0x10,0x10,0x10,0x10,0xFF,0xFF,0x10,0x10,
		0x10,0x10,0x10,0x10,0xF8,0xF8,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x04,
		0x24,0x24,0x24,0x24,0xFC,0xFC,0x24,0x34,0x7C,0x7C,0x2C,0x04,0x00,0xFF,0xFF,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,
		0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x7F,
		0x48,0x48,0x5F,0xDF,0x69,0x69,0x49,0x49,0xFF,0xFF,0x78,0x50,0x40,0xFF,0x7F,0x40,
		0x00,0x00,0x00,0x20,0x50,0x90,0x90,0xFF,0xFF,0x90,0xB1,0xB2,0x92,0xFF,0xFF,0x20,
		0x30,0x2D,0x26,0x23,0x25,0xF5,0xFC,0x08,0x00,0x00,0x04,0x88,0x10,0x30,0x7F,0xFF,
		0xA0,0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0xFF,0xFF,0x80,0x80,0x80,
		0x80,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};


	char bitmapcode2[1024]={0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0xF8,0xFC,0xFE,0x3F,0x0F,0x07,0x03,0xFD,0xFF,0xFE,0xEE,0xEE,0xEE,0xEE,0xEE,0xEE,
		0x00,0xEE,0xEE,0xEE,0xEE,0xEE,0xEE,0xFE,0xFE,0xFF,0xFD,0x03,0x07,0x0F,0x7F,0xFE,
		0xFC,0xE8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0xEC,0xCC,0x0C,0x0C,0x0C,0x0C,
		0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0xCC,0xCC,0x8C,0x8C,0x8C,0x8C,
		0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0xCC,0xCC,0x0C,0x0C,0x0C,
		0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,
		0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0xEC,0xEC,0x0C,0x0C,
		0x8C,0x8C,0x0C,0x0C,0x0C,0x0C,0x8C,0x8C,0x4C,0x4C,0x6C,0xEC,0xCC,0x0C,0x0C,0x0C,
		0x0C,0x0C,0x0C,0x0C,0x4C,0xEC,0xCC,0x8C,0x0C,0x0C,0x4C,0xEC,0xCC,0x8C,0x8C,0x0C,
		0x0C,0x0C,0x8C,0x8C,0xCC,0xCC,0x4C,0x0C,0x0C,0x0C,0x0C,0x0C,0xEC,0xCC,0x0C,0x0C,
		0x0C,0x0C,0x0C,0x0C,0x0C,0x8C,0x8C,0xCC,0xEC,0xCC,0xCC,0x0C,0x0C,0x0C,0x0C,0x0C,
		0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,
		0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,
		0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,
		0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,
		0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,
		0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,
		0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x00,0x00,0x00};

	char bitmapcode3[1024]={0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x80,0xC0,0xC0,0xE0,0xE0,0xF0,0xF0,0xF0,0x70,0x70,0x70,0x70,0x70,0x70,
		0x70,0x70,0x70,0x70,0xF0,0xF0,0xE0,0xE0,0xE0,0xC0,0xC0,0x80,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x7E,0x00,0x7E,0x30,0x0C,0x7E,0x00,0x00,0x7E,0x42,0x42,0x42,0x3C,0x00,0x7C,
		0x02,0x02,0x7C,0x00,0x76,0x5A,0x6E,0x00,0x00,0x40,0x40,0x7E,0x40,0x40,0x00,0x7E,
		0x50,0x5C,0x72,0x00,0x00,0x7E,0x06,0x3C,0x44,0x3C,0x06,0x00,0x00,0x7E,0x02,0x02,
		0x00,0x00,0x00,0x06,0x3C,0x44,0x3C,0x06,0x00,0x00,0x7E,0x30,0x0C,0x7E,0x00,0x7E,
		0x42,0x42,0x42,0x3C,0x00,0x00,0x3C,0x66,0x42,0x42,0x42,0x24,0x3C,0x66,0x42,0x42,
		0x66,0x3C,0x00,0x00,0x7E,0x78,0x06,0x78,0x7E,0x00,0x7E,0x78,0x06,0x78,0x7E,0x00,
		0x00,0x7E,0x52,0x52,0x52,0x00,0x00,0x7E,0x50,0x5C,0x72,0x00,0x7E,0x00,0x3C,0x66,
		0x42,0x42,0x42,0x24,0x7E,0x00,0x06,0x3C,0x44,0x3C,0x06,0x00,0x00,0x7E,0x02,0x02,
		0x00,0x00,0x00,0x00,0x7E,0x52,0x52,0x52,0x6E,0x3C,0x44,0x3C,0x06,0x00,0x00,0x7E,
		0x30,0x0C,0x7E,0x00,0x00,0x7E,0x18,0x28,0x46,0x00,0x00,0x00,0x3C,0x66,0x42,0x42,
		0x66,0x3C,0x00,0x00,0x7E,0x50,0x50,0x50,0x00,0x00,0x3C,0x66,0x42,0x42,0x42,0x24,
		0x00,0x7E,0x10,0x10,0x7E,0x00,0x7E,0x00,0x00,0x7E,0x30,0x0C,0x7E,0x00,0x06,0x3C,
		0x44,0x3C,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
	///////////////////////////////////////工商银行/////////////////////////////////////

	////////////////////////////////修改后新区///////////////////////////////////////////
	/*	char bitmapcode[1024] = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x03,0x03,0x07,0x0F,0x0F,0x0E,0x1E,0x1E,
	0x1E,0x1C,0x1C,0x1C,0x1C,0x1C,0x1C,0x1C,0x1C,0x1E,0x1E,0x1E,0x0E,0x0F,0x07,0x07,
	0x03,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x01,0x01,0x01,0x01,0x01,0x01,
	0x1F,0x1F,0x11,0x01,0x01,0x01,0x01,0x01,0x03,0x03,0x01,0x00,0x00,0x00,0x00,0x00,
	0x1F,0x0F,0x08,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,
	0x08,0x1F,0x1F,0x08,0x00,0x00,0x00,0x00,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,
	0x03,0x03,0x02,0x02,0x02,0x02,0x02,0x06,0x06,0x06,0x02,0x00,0x00,0x00,0x00,0x00,2x
	0x04,0x04,0x04,0x04,0x04,0x06,0x07,0x05,0x04,0x14,0x1C,0x1C,0x04,0x07,0x07,0x06,
	0x04,0x04,0x04,0x04,0x04,0x04,0x00,0x00,0x00,0x01,0x0F,0x1E,0x1A,0x12,0x02,0x02,
	0x02,0x1F,0x0F,0x09,0x09,0x09,0x09,0x09,0x09,0x0F,0x0F,0x08,0x00,0x00,0x00,0x00,
	0x01,0x02,0x06,0x1D,0x1B,0x11,0x00,0x00,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,
	0x0C,0x0C,0x05,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};


	char bitmapcode1[1024] = {0x00,0x00,
	0x00,0x00,0x3F,0x7F,0xFF,0xF0,0xE0,0xC0,0x80,0xFE,0xFE,0xFE,0xEE,0xEE,0xEF,0xEF,
	0xEF,0xEF,0xE0,0xE0,0xEF,0xEF,0xEF,0xEF,0xEE,0xFE,0xFE,0xFE,0xFE,0x80,0xE0,0xE0,
	0xF8,0xFF,0x7F,0x1F,0x00,0x00,0x00,0xF8,0x10,0x10,0x10,0x10,0x10,0x10,0xFF,0xFF,
	0x10,0x10,0x10,0x10,0x10,0x10,0xF8,0xF8,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,
	0x00,0x04,0x24,0x24,0x24,0x24,0xFC,0xFC,0x24,0x34,0x3C,0x3C,0x2C,0x04,0x00,0xFF,
	0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,
	0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0xFF,0x7F,0x40,0x48,0x5F,0xDF,0x69,0x69,0x49,0x49,0xFF,0xFF,0x78,0x50,0x40,0x7F,
	0x7F,0x40,0x00,0x00,0x00,0x20,0x50,0x90,0x90,0xFF,0xFF,0x90,0x91,0x92,0x92,0xFF,
	0xFF,0x20,0x30,0x2D,0x26,0x23,0x25,0xF5,0xFC,0x08,0x00,0x00,0x04,0x88,0x10,0x30,
	0x7F,0xFF,0xA0,0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0xFF,0xFF,0x80,
	0x80,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x00,0x10,0x10,0x12,0x13,0x3E,0x12,0x12,
	0x17,0x12,0x12,0x3E,0x13,0x12,0x11,0x10,0x10,0x00,0x00,0x01,0x07,0x00,0x3F,0x3F,
	0x04,0x02,0x00,0x3F,0x00,0x06,0x02,0x00,0x3F,0x00,0x00,0x00,0x12,0x12,0x1E,0x52,
	0x33,0x12,0x1E,0x12,0x00,0x00,0x1F,0x24,0x24,0x27,0x24,0x24,0x00,0x00,0x00,0x00,
	0x3F,0x10,0x10,0x18,0x14,0x15,0x13,0x16,0x1D,0x19,0x30,0x30,0x10,0x00,0x00,0x10,
	0x10,0x14,0x14,0x16,0x15,0x14,0x7C,0x14,0x15,0x17,0x16,0x14,0x14,0x10,0x10,0x00,
	0x00,0x09,0x12,0x27,0x48,0x04,0x04,0x14,0x14,0x14,0x14,0x17,0x17,0x34,0x34,0x14,
	0x04,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};

	char bitmapcode2[1024] = {0x00,0x00,0x00,0x00,
	0xF8,0xFC,0xFE,0x3F,0x0F,0x07,0x03,0xFD,0xFF,0xFE,0xEE,0xEE,0xEE,0xEE,0xEE,0xEE,
	0x0E,0x0E,0xEE,0xEE,0xEE,0xEE,0xEE,0xFE,0xFE,0xFF,0xFD,0x03,0x07,0x0F,0x7F,0xFE,
	0xFC,0xE8,0x00,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0xEC,0xCC,0x0C,0x0C,
	0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0xCC,0xCC,0x8C,0x8C,
	0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0xCC,0xCC,0x0C,
	0x0C,0x0C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,
	0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x8C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0xEC,0xEC,
	0x0C,0x0C,0x8C,0x8C,0x0C,0x0C,0x0C,0x0C,0x8C,0x8C,0x4C,0x4C,0x6C,0xEC,0xCC,0x0C,
	0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x4C,0xEC,0xCC,0x8C,0x0C,0x0C,0x4C,0xEC,0xCC,0x8C,
	0x8C,0x0C,0x0C,0x0C,0x8C,0x8C,0xCC,0xCC,0x4C,0x0C,0x0C,0x0C,0x0C,0x0C,0xEC,0xCC,
	0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x8C,0x8C,0xCC,0xEC,0xCC,0xCC,0x0C,0x0C,0x0C,
	0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x5C,0xDC,0xAC,0x2C,0x6C,0xCC,0x8C,0x1C,
	0x1C,0x7C,0xEC,0x0C,0x0C,0xCC,0x0C,0x0C,0x0C,0x1C,0x1C,0x2C,0xCC,0x8C,0x0C,0x0C,
	0x0C,0xEC,0x0C,0x0C,0x0C,0x0C,0xFC,0x0C,0x0C,0x0C,0x0C,0x2C,0xCC,0x8C,0xFC,0x8C,
	0xEC,0x1C,0x2C,0x6C,0x8C,0x0C,0x0C,0xFC,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0xEC,0x2C,
	0x6C,0xAC,0xAC,0x2C,0x2C,0x2C,0x2C,0xAC,0xAC,0x6C,0x2C,0x0C,0x0C,0x1C,0x1C,0x1C,
	0x2C,0x2C,0x2C,0xCC,0x4C,0xCC,0xCC,0x6C,0x2C,0x2C,0x3C,0x3C,0x2C,0x0C,0x0C,0x0C,
	0x0C,0xFC,0x0C,0x0C,0x0C,0x0C,0x0C,0x2C,0x3C,0xFC,0xFC,0x0C,0x0C,0x0C,0x0C,0x0C,
	0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,
	0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C};

	char bitmapcode3[1024] = {0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x80,0xC0,0xC0,0xE0,0xE0,0xF0,0xF0,0xF0,0x70,0x70,0x70,0x70,0x70,0x70,
	0x70,0x70,0x70,0x70,0xF0,0xF0,0xE0,0xE0,0xE0,0xC0,0xC0,0x80,0x00,0x00,0x00,0x00,
	0x00,0x7E,0x00,0x7E,0x30,0x0C,0x7E,0x00,0x7E,0x42,0x42,0x42,0x3C,0x00,0x7C,0x02,
	0x02,0x7C,0x00,0x76,0x5A,0x6E,0x00,0x00,0x40,0x40,0x7E,0x40,0x40,0x7E,0x50,0x5C,
	0x72,0x00,0x00,0x7E,0x06,0x3C,0x44,0x3C,0x06,0x00,0x00,0x7E,0x02,0x02,0x00,0x00,
	0x06,0x3C,0x44,0x3C,0x06,0x00,0x00,0x7E,0x30,0x0C,0x7E,0x00,0x7E,0x42,0x42,0x42,
	0x3C,0x00,0x00,0x3C,0x66,0x42,0x42,0x42,0x24,0x3C,0x66,0x42,0x42,0x66,0x3C,0x00,
	0x7E,0x78,0x06,0x78,0x7E,0x00,0x7E,0x78,0x06,0x78,0x7E,0x00,0x7E,0x52,0x52,0x52,
	0x00,0x00,0x7E,0x50,0x5C,0x72,0x00,0x7E,0x3C,0x66,0x42,0x42,0x42,0x24,0x00,0x7E,
	0x06,0x3C,0x44,0x3C,0x06,0x00,0x00,0x7E,0x02,0x02,0x00,0x00,0x00,0x7E,0x52,0x52,
	0x52,0x6C,0x06,0x3C,0x44,0x3C,0x06,0x00,0x7E,0x30,0x0C,0x7E,0x00,0x00,0x7E,0x18,
	0x28,0x46,0x00,0x00,0x00,0x3C,0x66,0x42,0x42,0x66,0x3C,0x00,0x7E,0x50,0x50,0x50,
	0x00,0x00,0x3C,0x66,0x42,0x42,0x42,0x24,0x7E,0x10,0x10,0x7E,0x00,0x00,0x7E,0x00,
	0x7E,0x30,0x0C,0x7E,0x06,0x3C,0x44,0x3C,0x06,0x00,0x00,0x00,0x00,0x00,0x24,0x52,
	0x52,0x52,0x4C,0x00,0x7E,0x30,0x0C,0x7E,0x00,0x00,0x7E,0x42,0x42,0x7C,0x00,0x00,
	0x24,0x52,0x52,0x52,0x4C,0x00,0x7E,0x02,0x02,0x7E,0x00,0x00,0x7E,0x52,0x52,0x2C,
	0x00,0x00,0x00,0x7E,0x52,0x52,0x2C,0x00,0x7E,0x50,0x58,0x76,0x02,0x06,0x38,0x48,
	0x38,0x06,0x00,0x7E,0x30,0x0C,0x7E,0x38,0x46,0x42,0x42,0x66,0x00,0x00,0x7E,0x10,
	0x10,0x7E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};*/

	////////////////////////////////////建设银行/////////////////////////////////////////
	/*char bitmapcode[1024]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x03,
	0x03,0x07,0x07,0x07,0x0F,0x0F,0x1F,0x1F,0x1F,0x1F,0x1F,0x1F,0x1F,0x1F,0x1F,0x1F,
	0x0F,0x07,0x17,0x13,0x19,0x1C,0x1E,0x1F,0x0F,0x07,0x03,0x01,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x1F,0x1F,0x00,0x00,0x00,0x00,0x00,0x00,
	0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0x0F,0x04,0x05,0x05,0x05,0x05,
	0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x05,0x04,0x0F,0x0F,0x00,0x00,0x00,0x04,
	0x04,0x04,0x05,0x07,0x0E,0x04,0x04,0x02,0x02,0x02,0x02,0x0F,0x0F,0x02,0x02,0x02,
	0x07,0x03,0x02,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x0C,0x0E,0x06,0x00,
	0x00,0x00,0x00,0x0F,0x0F,0x08,0x08,0x08,0x0F,0x0F,0x08,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x07,0x1F,0x0D,0x01,0x01,0x03,0x01,0x0F,0x0F,0x04,0x04,0x04,
	0x04,0x04,0x04,0x0F,0x0F,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x06,0x0E,0x1C,
	0x09,0x01,0x00,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};

	char bitmapcode1[1024]={0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x03,0x0F,0x3F,0x7F,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
	0xFF,0xFF,0xFE,0xFE,0xFC,0xFC,0xF8,0xF0,0xF0,0xF0,0xF0,0xF8,0xFC,0xFC,0xFE,0xFE,
	0xFE,0xFE,0xFE,0xFE,0x7E,0x3E,0x9E,0xCE,0xE0,0xF0,0xF8,0x78,0x38,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFC,0xFC,
	0x88,0x88,0x88,0x88,0x88,0x88,0xFF,0xFF,0x88,0x88,0x88,0x88,0x88,0x88,0xFC,0xFC,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x02,0x22,0x22,0x22,0x22,0xFE,
	0xFE,0x22,0x32,0x2A,0x2E,0x26,0x02,0x00,0xFF,0xFF,0x00,0x00,0x00,0x00,0x28,0x76,
	0xE1,0x23,0x7F,0xBA,0xAA,0xAA,0xAA,0xAA,0xAA,0xFF,0xFF,0xAA,0xAA,0xAA,0xFA,0xFE,
	0x8A,0x80,0x80,0x80,0x00,0x00,0x40,0x40,0x40,0x40,0xFF,0x7F,0x40,0x01,0x21,0x22,
	0x60,0xB0,0x2C,0x23,0x21,0x23,0xEE,0xFC,0x70,0x60,0x40,0xC0,0x40,0x00,0x00,0x10,
	0x68,0xC8,0xC8,0x7F,0x7F,0x48,0x58,0xD9,0x49,0xFF,0xFF,0x90,0x98,0x96,0x93,0x91,
	0x92,0xFA,0xFE,0x04,0x00,0x00,0x00,0x00,0x02,0x84,0x08,0x18,0x3F,0xFF,0xD0,0x80,
	0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x7F,0x7F,0x40,0x40,0x40,0x40,0x40,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};

	char bitmapcode2[1024]={0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0xF0,0xFC,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x3F,
	0x1F,0x1F,0x0F,0x0F,0x07,0x03,0x03,0x07,0x07,0x0F,0x1F,0x1F,0x3F,0x3F,0x7F,0xFF,
	0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0xF8,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,
	0x01,0x00,0x00,0x00,0xF0,0xF1,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0xE0,0xE0,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,
	0x40,0x40,0x40,0x41,0x41,0x41,0xE1,0xE0,0x00,0x00,0x10,0x10,0x20,0x40,0x80,0x00,
	0x80,0x80,0xC0,0xC0,0x40,0x40,0x40,0xE0,0xE0,0x60,0x60,0x60,0x60,0x60,0x60,0x41,
	0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x60,0xE0,0xC0,0x90,0x10,0x20,0x20,0x20,0x40,
	0x40,0x80,0x80,0x80,0xC0,0xC1,0x60,0x60,0x61,0x40,0x00,0x00,0x00,0x00,0x00,0x00,
	0x20,0xF0,0xE0,0x40,0x80,0x00,0x20,0xF0,0xE0,0x40,0x40,0x80,0x80,0x80,0xC1,0xC1,
	0x61,0x61,0x21,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0xF0,0x00,0x00,0x00,0x00,
	0x00,0x00,0x40,0x40,0x60,0x71,0xE0,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};


	char bitmapcode3[1024]={0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x80,0x80,0xC0,0xE0,0xE0,0xF0,0xF0,0xF0,0xF0,0xF8,0xF8,0xFC,
	0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xF8,0xF8,0xF8,0xF0,0xF0,
	0xE0,0xC0,0xC0,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x78,0x84,0x02,0x02,0x02,0x86,0x84,
	0x00,0x00,0x00,0xFE,0x20,0x40,0x40,0x3E,0x00,0x00,0x7E,0x00,0x00,0x7E,0x40,0x40,
	0x40,0x3E,0x00,0x00,0x2C,0x52,0x52,0x54,0x3E,0x00,0x00,0x00,0x00,0x00,0x00,0x78,
	0x84,0x02,0x02,0x02,0x86,0x84,0x00,0x00,0x00,0x3C,0x42,0x42,0x42,0x3C,0x00,0x00,
	0x7E,0x40,0x40,0x40,0x3E,0x00,0x00,0x34,0x52,0x52,0x4A,0x2C,0x40,0xFE,0x42,0x00,
	0x7E,0x20,0x40,0x00,0x00,0x7C,0x02,0x02,0x04,0x7E,0x00,0x00,0x3C,0x42,0x42,0x42,
	0x24,0x00,0x40,0xFE,0x42,0x00,0x7E,0x00,0x00,0x00,0x3C,0x42,0x42,0x42,0x3C,0x00,
	0x00,0x7E,0x40,0x40,0x40,0x3E,0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0x22,0x22,0x22,
	0x22,0x22,0xFC,0x00,0x2C,0x52,0x52,0x54,0x3E,0x00,0x00,0x7E,0x40,0x40,0x40,0x3E,
	0x00,0x00,0x00,0xFE,0x08,0x18,0x64,0x42,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};*/
	///////////////////////////////////建设银行//////////////////////////////////////////



	CString strtemp;
	char ctemp[255];
	char cpacket[255];
	ULONG nSend = 0;
	int nlen = 0;
	int i;
	memset(ctemp,0,sizeof(ctemp));
	memset(cpacket,0,sizeof(cpacket));
	memset(chineseforml,0,sizeof(chineseforml));
	memset(chineseforml1,0,sizeof(chineseforml1));
	memset(chineseformS,0,sizeof(chineseformS));
	memset(chineseformS1,0,sizeof(chineseformS1));
	memset(characterformL,0,sizeof(characterformL));
	memset(characterformL1,0,sizeof(characterformL1));
	memset(characterformS,0,sizeof(characterformS));
	memset(chineseformS2,0,sizeof(chineseformS2));
	memset(bitmapform,0,sizeof(bitmapform));
	memset(bitmapform1,0,sizeof(bitmapform1));
	memset(bitmapform2,0,sizeof(bitmapform2));
	memset(bitmapform3,0,sizeof(bitmapform3));
	memset(bitmapform4,0,sizeof(bitmapform4));




	chineseforml[0] = (BYTE)0x1B;
	chineseforml[1] = (BYTE)0x40;
	chineseforml[2] = (BYTE)0x1C;
	chineseforml[3] = (BYTE)0x26;
	//chineseforml[4] = (BYTE)0x1C;
	chineseforml[4] = (BYTE)0x1B;
	chineseforml[5] = (BYTE)0x21;
	//chineseforml[6] = (BYTE)0x0C; 
	chineseforml[6] = (BYTE)0x30; 
	chineseforml[7] = (BYTE)0x1B;
	chineseforml[8] = (BYTE)0x61;
	//chineseforml[9] = (BYTE)0x01;
	chineseforml[9] = (BYTE)0x00;
	chineseforml[10] = (BYTE)0x1B;
	chineseforml[11] = (BYTE)0x33;
	chineseforml[12] = (BYTE)0x30;
	//chineseforml[12] = (BYTE)0x00;
	strcpy(chineseformS,chineseforml);
	chineseformS[6] = (BYTE)0x00;
	//chineseformS[6] = (BYTE)0x30;
	//chineseformS[6] = (BYTE)0x10;


	strcpy(characterformS,chineseforml);
	characterformS[3] = (BYTE)0x2E;
	characterformS[4] = (BYTE)0x1B;
	//	characterformS[6] = (BYTE)0x00;
	characterformS[6] = (BYTE)0x0C;


	////chineseforml1是业务名称和编号 大写的字体
	strcpy(characterformL,characterformS);
	characterformS[6] = (BYTE)0x30;
	chineseforml1[0] = (BYTE)0x1C;
	chineseforml1[1] = (BYTE)0x26;
	chineseforml1[2] = (BYTE)0x1C;
	//chineseforml1[2] = (BYTE)0X1B;
	chineseforml1[3] = (BYTE)0x21;
	chineseforml1[4] = (BYTE)0x0C;
	//chineseforml1[4] = (BYTE)0x30;
	//chineseforml1[4] = (BYTE)0x00;
	chineseforml1[5] = (BYTE)0x1B;
	chineseforml1[6] = (BYTE)0x61;
	chineseforml1[7] = (BYTE)0x01;
	//chineseforml1[7] = (BYTE)0x00;
	chineseforml1[8] = (BYTE)0x1B;
	chineseforml1[9] = (BYTE)0x33;
	chineseforml1[10] = (BYTE)0x30;
	//chineseforml1[10] = (BYTE)0x00;
	strcpy(chineseformS1,chineseforml1);
	chineseformS1[4] = (BYTE)0x00;
	strcpy(characterformL1,chineseformS1);
	characterformL1[1] = (BYTE)0x2E;
	characterformL1[2] = (BYTE)0x1B;
	characterformL1[4] = (BYTE)0x30;
	strcpy(chineseformS2,chineseforml1);///characterformS1 是备注信息小字体
	chineseformS2[2] = (BYTE)0x1B;
	chineseformS2[4] = (BYTE)0x0C;

	//const int num= 270;





	bitmapform[0] = (BYTE)0X1B;
	bitmapform[1] = (BYTE)0X40;
	//bitmapform[0] = (BYTE) 0X1C;
	//bitmapform[1] = (BYTE) 0X26;

	bitmapform[2] = (BYTE)0X1B;
	bitmapform[3] = (BYTE)0X2A;
	bitmapform[4] = (BYTE)0X00;//m
	//	bitmapform[4] = (BYTE) 0X20;
	//bitmapform[5]= (BYTE)0X0F;
	bitmapform[5]= (BYTE)0X3F;

	//bitmapform[6] = (BYTE)0X00;//n2
	bitmapform[6] = (BYTE)0x01;
	//bitmapform[6] = (BYTE)0X02;
	//bitmapform[6] = (BYTE)0X03;
	for (i=7;i<325;i++)
	{
		bitmapform[i]= bitmapcode[i-7];
		//  bitmapform[i]=0XFF;
	};







	bitmapform1[0] = (BYTE)0X1B;
	bitmapform1[1] = (BYTE)0X40;
	//bitmapform[0] = (BYTE) 0X1C;
	//bitmapform[1] = (BYTE) 0X26;

	bitmapform1[2] = (BYTE)0X1B;
	bitmapform1[3] = (BYTE)0X2A;
	bitmapform1[4] = (BYTE)0X00;//m
	//	bitmapform1[4] = (BYTE) 0X20;
	//bitmapform1[5]= (BYTE)0X0F;
	bitmapform1[5]= (BYTE)0X3F;
	//bitmapform1[6] = (BYTE)0X00;//n2
	bitmapform1[6] = (BYTE)0x01;
	//bitmapform1[6] = (BYTE)0X02;
	//bitmapform1[6] = (BYTE)0X03;

	for (i=7;i<325;i++)
	{
		bitmapform1[i]= bitmapcode1[i-7];
		// bitmapform1[i]=0XFF;
	};



	bitmapform2[0] = (BYTE)0X1B;
	bitmapform2[1] = (BYTE)0X40;
	bitmapform2[2] = (BYTE)0X1B;
	bitmapform2[3] = (BYTE)0X2A;
	bitmapform2[4] = (BYTE)0X00;//m
	//	bitmapform2[4] = (BYTE) 0X20;
	//bitmapform2[5]= (BYTE)0X0F;
	bitmapform2[5]= (BYTE)0X3F;

	//bitmapform2[6] = (BYTE)0X00;//n2
	bitmapform2[6] = (BYTE)0x01;
	//bitmapform2[6] = (BYTE)0X02;
	//bitmapform2[6] = (BYTE)0X03;
	for (i=7;i<325;i++)
	{

		bitmapform2[i]= bitmapcode2[i-7];
		//bitmapform2[i]=0XFF;
	};




	bitmapform3[0] = (BYTE)0X1B;
	bitmapform3[1] = (BYTE)0X40;
	//bitmapform[0] = (BYTE) 0X1C;
	//bitmapform[1] = (BYTE) 0X26;

	bitmapform3[2] = (BYTE)0X1B;
	bitmapform3[3] = (BYTE)0X2A;
	bitmapform3[4] = (BYTE)0X00;//m
	//	bitmapform3[4] = (BYTE) 0X20;
	//bitmapform3[5]= (BYTE)0X0F;
	bitmapform3[5]= (BYTE)0X3F;

	//bitmapform3[6] = (BYTE)0X00;//n2
	bitmapform3[6] = (BYTE)0x01;
	//bitmapform3[6] = (BYTE)0X02;
	//bitmapform3[6] = (BYTE)0X03;


	for (i=7;i<325;i++)
	{
		bitmapform3[i]= bitmapcode3[i-7];
		//  bitmapform3[i]=0XFF;
	};




	bitmapform4[0] = (BYTE)0X1B;
	bitmapform4[1] = (BYTE)0X40;
	//bitmapform[0] = (BYTE) 0X1C;
	//bitmapform[1] = (BYTE) 0X26;

	bitmapform4[2] = (BYTE)0X1B;
	bitmapform4[3] = (BYTE)0X2A;
	bitmapform4[4] = (BYTE)0X00;//m
	//	bitmapform4[4] = (BYTE) 0X20;
	//bitmapform4[5]= (BYTE)0X0F;
	bitmapform4[5]= (BYTE)0X3F;

	//bitmapform4[6] = (BYTE)0X00;//n2
	bitmapform4[6] = (BYTE)0x01;
	//bitmapform4[6] = (BYTE)0X02;
	//bitmapform4[6] = (BYTE)0X03;


	for (i=7;i<325;i++)
	{
		//bitmapform4[i]= bitmapcode3[i-7];
		bitmapform4[i]=0XFF;
	};





	hComm = CreateFile( "lpt1:", GENERIC_READ | GENERIC_WRITE, 0, 
		NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL , NULL );
	if ( INVALID_HANDLE_VALUE==hComm )
	{
		TRACE( "Error in open COM port.\n" );
		return ; 
	}




	ctemp[0] = 0X1B;
	ctemp[1] = 0x4A;
	ctemp[2]= 0x10;
	nlen = 3;
	//ctemp[0] = 0x0A;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printwait");

	if (!WriteFile(hComm,chineseformS,13,&nSend,NULL))
		AfxMessageBox("chineseformS");      
	//strtemp = "你的号码为";
	strtemp = "     客户编号：";
	memset(ctemp,0,sizeof(ctemp));
	memcpy(ctemp,strtemp,strtemp.GetLength());
	nlen = strtemp.GetLength();
	ctemp[nlen] = 0x20;
	nlen = nlen + 1;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printwelcome");

	if (!WriteFile(hComm,characterformL1,11,&nSend,NULL))
		AfxMessageBox("characterformL1");	
	strtemp = strnumber.Right(4);
	memset(ctemp,0,sizeof(ctemp));
	memcpy(ctemp,strtemp,strtemp.GetLength());
	nlen = strtemp.GetLength();
	//ctemp[nlen] = 0x32;
	//nlen = nlen + 1;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printbusiness");
	ctemp[0] = 0X1B;
	ctemp[1] = 0x4A;
	///	ctemp[2]= 0x00;   名称是大写
	ctemp[2]= 0x40;    // 小写
	nlen =3;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printwait");



	if (!WriteFile(hComm,chineseformS,13,&nSend,NULL))
		AfxMessageBox("chineseformS");
	//strtemp = "欢迎你办理";
	strtemp = "     业务名称：";
	memset(ctemp,0,sizeof(ctemp));
	memcpy(ctemp,strtemp,strtemp.GetLength());
	nlen = strtemp.GetLength();
	ctemp[nlen] = 0x20;
	nlen = nlen + 1;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printwelcome");

	if (!WriteFile(hComm,chineseformS2,13,&nSend,NULL))
		AfxMessageBox("chineseforml1");	
	strtemp = stroperation;
	memset(ctemp,0,sizeof(ctemp));
	memcpy(ctemp,strtemp,strtemp.GetLength());
	nlen = strtemp.GetLength();
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printbusiness");
	ctemp[0] = 0X1B;
	ctemp[1] = 0x4A;
	//ctemp[2]= 0x40;//  名称是大写
	ctemp[2]= 0x30;
	nlen =3;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printwait");



	/*if (!WriteFile(hComm,chineseformS1,13,&nSend,NULL))
	AfxMessageBox("chineseformS1");
	strtemp = "业务";
	memset(ctemp,0,sizeof(ctemp));
	memcpy(ctemp,strtemp,strtemp.GetLength());
	nlen = strtemp.GetLength();*/
	//ctemp[nlen] = '\n';
	//nlen = nlen + 1;
	/*	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
	AfxMessageBox("printmode");*/

	/*	memset(ctemp,0,sizeof(ctemp));
	ctemp[0] = '\n';
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
	AfxMessageBox("回车");*/







	if (!WriteFile(hComm,chineseformS,13,&nSend,NULL))
		AfxMessageBox("chineseformS");
	//strtemp = "欢迎你办理";
	strtemp = "     业务说明：";
	memset(ctemp,0,sizeof(ctemp));
	memcpy(ctemp,strtemp,strtemp.GetLength());
	nlen = strtemp.GetLength();
	ctemp[nlen] = 0x20;
	nlen = nlen + 1;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printwelcome");


	//////////////////////////////////////////////////////打印备注信息处
	if (!WriteFile(hComm,chineseformS2,13,&nSend,NULL))
		AfxMessageBox("chineseformS2");
	strtemp =  strRemark;   
	memset(ctemp,0,sizeof(ctemp));
	memcpy(ctemp,strtemp,strtemp.GetLength());
	nlen = strtemp.GetLength();
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printbusiness");
	ctemp[0] = 0X1B;
	ctemp[1] = 0x4A;
	ctemp[2]= 0x30;
	nlen =3;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printwait");





	if (!WriteFile(hComm,chineseformS,13,&nSend,NULL))
		AfxMessageBox("chineseformS");
	strtemp = "     取号时间：";
	memset(ctemp,0,sizeof(ctemp));
	memcpy(ctemp,strtemp,strtemp.GetLength());
	nlen = strtemp.GetLength();
	ctemp[nlen] = 0x20;
	nlen = nlen + 1;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printwelcome");


	oletime = COleDateTime::GetCurrentTime();
	strtemp.Format("%d/%d/%d",oletime.GetYear(),oletime.GetMonth(),oletime.GetDay());
	//strtemp.Format("%d/%d/%d %d:%d:%d",oletime.GetYear(),oletime.GetMonth(),oletime.GetDay(),oletime.GetHour(),oletime.GetMinute(),oletime.GetSecond());
	memset(ctemp,0,sizeof(ctemp));
	memcpy(ctemp,strtemp,strtemp.GetLength());
	nlen = strtemp.GetLength();
	ctemp[nlen] = '\n';
	//nlen = nlen + 1;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printwait");
	ctemp[0] = 0X1B;
	ctemp[1] = 0x4A;
	ctemp[2]= 0x30;
	nlen =3;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printwait");



	if (!WriteFile(hComm,characterformS,13,&nSend,NULL))
		AfxMessageBox("characterformS");
	memset(ctemp,0,sizeof(ctemp));
	ctemp[0] = '\n';
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("回车");
	/*if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
	AfxMessageBox("回车");*/


	/*if(!WriteFile(hComm,chineseforml1,13,&nSend,NULL))
	AfxMessageBox("chinsesforml1");
	strtemp = strBankName;
	memset(ctemp,0,sizeof(ctemp));
	memcpy(ctemp,strtemp,strtemp.GetLength());
	nlen = strtemp.GetLength();	
	ctemp[nlen] = '\n';
	nlen = nlen + 1;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
	AfxMessageBox("printwait");*/

	if (!WriteFile(hComm,characterformS,13,&nSend,NULL))
		AfxMessageBox("characterformS");
	memset(ctemp,0,sizeof(ctemp));
	ctemp[0] = '\n';
	//if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
	//	AfxMessageBox("回车");
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("回车");


	if(!WriteFile(hComm,bitmapform,326,&nSend,NULL))
		AfxMessageBox("bitmapform");
	ctemp[0] = 0X1B;
	ctemp[1] = 0x4A;
	ctemp[2]= 0x00;
	nlen = 3;
	//ctemp[0] = 0x0A;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printwait");



	if(!WriteFile(hComm,bitmapform1,326,&nSend,NULL))
		AfxMessageBox("bitmapform1");
	//ctemp[nlen] = '\n';
	ctemp[0] = 0X1B;
	ctemp[1] = 0x4A;
	ctemp[2]= 0x00;
	nlen =3;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printwait");

	if(!WriteFile(hComm,bitmapform2,326,&nSend,NULL))
		AfxMessageBox("bitmapform2");
	ctemp[0] = 0X1B;
	ctemp[1] = 0x4A;
	ctemp[2]= 0x00;
	nlen = 3;
	//ctemp[0] = 0x0A;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printwait");


	if(!WriteFile(hComm,bitmapform3,326,&nSend,NULL))
		AfxMessageBox("bitmapform3");
	//ctemp[nlen] = '\n';
	ctemp[0] = 0X1B;
	ctemp[1] = 0x4A;
	ctemp[2]= 0x00;
	nlen =3;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("printwait");


	/*if(!WriteFile(hComm,bitmapform4,326,&nSend,NULL))
	AfxMessageBox("bitmapform4");
	//ctemp[nlen] = '\n';
	ctemp[0] = 0X1B;
	ctemp[1] = 0x4A;
	ctemp[2]= 0x00;
	nlen =3;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
	AfxMessageBox("printwait");*/   



	memset(ctemp,0,sizeof(ctemp));
	ctemp[0] = 0x1B;
	strtemp = "i";
	memcpy(ctemp + 1,strtemp,strtemp.GetLength());
	nlen = 2;
	if (!WriteFile(hComm,ctemp,nlen,&nSend,NULL))
		AfxMessageBox("切纸");
	memset(ctemp,0,sizeof(ctemp));
	ctemp[0] = '\n';


	CloseHandle(hComm);
}